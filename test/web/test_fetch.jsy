import * as test_bdd from '#test_bdd'
import {expect} from 'chai'

import {validate_backend} from '@phorbas/store/esm/validate_backend.js'
import {bkc_fetch} from '@phorbas/store/esm/web/fetch.js'

if globalThis.fetch ::
  test_bdd.describe @ 'bkc_fetch variants', @::>
    validate_backend @ test_bdd,
      'fetch with param `node int--core/node-http-store.mjs`',
      () => bkc_fetch(new URL('http://127.0.0.1:9099/browser/param/a/b/c/'))

    validate_backend @ test_bdd,
      'fetch immutable with param `node int--core/node-http-store.mjs`',
      () => bkc_fetch @
        new URL('http://127.0.0.1:9099/browser/param/a/b/c/')
        @{} immutable: true

    validate_backend @ test_bdd,
      'fetch with shared `node int--core/node-http-store.mjs`',
      () => bkc_fetch(new URL('http://127.0.0.1:9099/browser/shared/d/e/f/'))

