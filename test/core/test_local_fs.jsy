import * as test_bdd from '#test_bdd'
import {validate_backend} from '@phorbas/store/esm/validate_backend.js'
import {bkc_with_fs} from '@phorbas/store/esm/local/local_fs.js'

var fs_module
if globalThis.process?.versions?.node ::
  fs_module = import('node:fs')

fs_module && test_bdd.describe @ 'bkc_with_fs', @::>
  let base = await fs_module.then(m => m.mkdtempSync('var-test-bkc_local_fs'))

  validate_backend @ test_bdd, 'bkc_with_fs', ()=> bkc_with_fs({fs: fs_module, base})
  validate_backend @ test_bdd, 'bkc_with_fs immutable', ()=> bkc_with_fs({fs: fs_module, base, immutable: true})
